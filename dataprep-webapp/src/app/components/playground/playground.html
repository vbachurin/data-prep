<!--
  ~ ============================================================================
  ~
  ~  Copyright (C) 2006-2016 Talend Inc. - www.talend.com
  ~
  ~  This source code is available under agreement available at
  ~  https://github.com/Talend/data-prep/blob/master/LICENSE
  ~
  ~  You should have received a copy of the agreement
  ~  along with this program; if not, write to Talend SA
  ~  9 rue Pages 92150 Suresnes, France
  ~
  ~ ============================================================================
  -->

<div class="playground-container fullscreen">
    <label class="talend-modal-close modal-header-close" ng-click="playgroundCtrl.beforeClose()"></label>
    <div class="modal-header playground-header">
        <ul class="left-header" insertion-playground-left-header>
            <li id="dataset-header-details"
                ng-switch="!!playgroundCtrl.state.playground.dataset.limit">

                <span class="playground-dataset-name" translate="FILE_DETAILS_NAME"
                      title="{{playgroundCtrl.state.playground.dataset.name}}"
                      translate-value-name="{{playgroundCtrl.state.playground.dataset.name}}"></span>
                <span class="playground-dataset-name">-</span>
                <span class="file-lines-count" ng-switch-when="false" translate="FILE_DETAILS_LINES"
                      translate-value-records="{{playgroundCtrl.state.playground.dataset.records}}"></span>
                <span class="file-lines-count" ng-switch-when="true" translate="FILE_DETAILS_LIMIT"
                      translate-value-records="{{playgroundCtrl.state.playground.dataset.limit}}"></span>

                <a id="playground-gear-icon"
                   class="icon"
                   data-icon="L"
                   ng-click="playgroundCtrl.toggleParameters()"
                   translate-once-title="DATAGRID_PARAMETERS_GEAR"></a>
            </li>
        </ul>

        <ul class="right-header">
            <li class="preview" ng-if="playgroundCtrl.previewInProgress()">
                <div class="previewBadge">
                    <img src="assets/images/eye.svg" alt="Blue Square" height="24px" class="previewBadgeElement"/>
                    <span class="previewBadgeElement">Preview</span>
                </div>
            </li>
            <li>
                <a id="playground-lookup-icon"
                   ng-click="playgroundCtrl.toggleLookup()"
                   ng-class="{pressed: playgroundCtrl.state.playground.lookup.visibility}">
                    <img src="assets/images/lookup/lookup-button.png">
                </a>
            </li>
            <li>
                <export></export>
            </li>
            <li class="nav-link" translate-once-title="ONBOARDING">
                <a id="playground-onboarding-icon"
                   class="icon"
                   data-icon="y"
                   ng-click="playgroundCtrl.startOnBoarding('playground')"></a>
            </li>
            <li class="nav-link" translate-once-title="FEEDBACK_TOOLTIP">
                <a id="playground-feedback-icon"
                   class="icon"
                   data-icon="H"
                   ng-click="playgroundCtrl.openFeedbackForm()"></a>
            </li>
            <li id="help-history">
                <history-control></history-control>
            </li>
        </ul>
    </div>

    <div class="modal-body playground">
        <talend-slidable class="playground-recipe slide-hide"
                         visible="playgroundCtrl.state.playground.recipe.visible"
                         side="left">
            <!-- Recipe Header -->
            <div class="steps-header">
                <label class="label-switch" ng-if="playgroundCtrl.recipeService.getRecipe().length">
                    <input type="checkbox"
                           ng-model='playgroundCtrl.hasActiveStep'
                           ng-change='playgroundCtrl.toggleRecipe()'/>

                    <div id="recipe-toggle-switch" class="checkbox"></div>
                </label>

                <div id="help-preparation-name">
                    <talend-editable-text edition-mode="playgroundCtrl.state.playground.nameEditionMode"
                                          on-validate="playgroundCtrl.confirmPrepNameEdition(text)"
                                          placeholder="ENTER_PREPARATION_NAME"
                                          text="playgroundCtrl.state.playground.preparationName"
                                          text-class="steps-header-preparation-text"
                                          text-title="{{playgroundCtrl.state.playground.preparationName}}"></talend-editable-text>
                </div>
            </div>

            <!-- Recipe -->
            <recipe id="help-recipe"></recipe>
        </talend-slidable>

        <div class="playground-center">
            <talend-slidable id="playground-dataset-parameters"
                             class="slide-hide"
                             visible="playgroundCtrl.state.playground.parameters.visible"
                             side="top"
                             control-bar="false">
                <dataset-parameters on-parameters-change="playgroundCtrl.changeDatasetParameters(parameters)"
                                    processing="playgroundCtrl.state.playground.parameters.isSending"
                                    dataset="playgroundCtrl.state.playground.dataset"
                                    configuration="playgroundCtrl.state.playground.parameters.configuration"
                                    parameters="playgroundCtrl.state.playground.parameters.values"></dataset-parameters>
            </talend-slidable>

            <filter-bar id="playground-filter-bar"></filter-bar>

            <div id="playground-datagrid-container">
                <datagrid></datagrid>
            </div>

            <talend-slidable
                    class="slide-hide"
                    visible="playgroundCtrl.state.playground.lookup.visibility"
                    side="bottom"
                    control-bar="false">
                <lookup></lookup>
            </talend-slidable>
        </div>

        <talend-slidable class="playground-suggestions"
                         visible="true"
                         side="right">
            <suggestions-stats></suggestions-stats>
        </talend-slidable>
    </div>
</div>

<talend-modal
        fullscreen="false"
        state="playgroundCtrl.showNameValidation"
        disable-enter="true"
        close-button="true">
    <div class="modal-title" translate-once="SAVE_CHANGE"></div>
    <br/>

    <div translate-once="SAVE_CHANGE_DESCRITION_1"></div>
    <div translate-once="SAVE_CHANGE_DESCRITION_2"></div>
    <br/><br/>

    <form id="playground-save-form" name="savePreparationForm"
          ng-submit="savePreparationForm.$valid && playgroundCtrl.confirmSaveOnClose()">

        <div class="modal-form-row">
            <div class="param-name" translate-once="PREPARATION_NAME"></div>
            <input type="text"
                   id="playground-save-name-input"
                   class="param-input"
                   translate-once-placeholder="ENTER_PREPARATION_NAME"
                   ng-model="playgroundCtrl.state.playground.preparationName"
                   can-be-blank="false"/>
        </div>

        <div class="modal-buttons">
            <a class="modal-secondary-button"
               ng-click="playgroundCtrl.discardSaveOnClose()" translate-once="NO_THANKS"></a>
            <talend-button-loader button-class="modal-primary-button btn-primary"
                                  disable-condition="savePreparationForm.$invalid || playgroundCtrl.saveInProgress"
                                  loading="playgroundCtrl.saveInProgress"
                                  loading-class="icon">
                <span translate-once="SAVE_IT"></span>
            </talend-button-loader>
        </div>
    </form>
</talend-modal>
